%% -*- coding:utf-8 -*- 
\section{Representation of the density operator through coherent
  states}
An important aspect for quantum optics is the description of optical phenomena using coherent states. Using twice the completeness condition for states with different photon numbers, for an arbitrary statistical operator we obtain: 
\[
\hat{\rho} = \hat{I}\hat{\rho}\hat{I} = 
\sum_{(n)}\sum_{(m)}
\ket{n}\bra{n}\hat{\rho}\ket{m}\bra{m} = 
\sum_{(n)}\sum_{(m)} \rho_{mn}\ket{n}\bra{m}
\]
Similarly, for coherent states
\begin{eqnarray}
\hat{\rho} = \hat{I}\hat{\rho}\hat{I} = 
\frac{1}{\pi^2}\int d^2\alpha\int
\left|\alpha\right>\left<\alpha\right|\hat{\rho}\left|\beta\right>\left<\beta\right|
d^2 \beta = 
\nonumber \\
= \frac{1}{\pi^2} \int d^2\alpha \int
R\left(\alpha^{*}, \beta\right) e^{-\frac{1}{2}\left|\alpha\right|^2 -\frac{1}{2}\left|\beta\right|^2}
\left|\alpha\right>\left<\beta\right|d^2 \beta ,
\end{eqnarray}
where
\[
R\left(\alpha^{*}, \beta\right) =
\left<\alpha\right|\hat{\rho}\left|\beta\right>
e^{\frac{1}{2}\left|\alpha\right|^2 +\frac{1}{2}\left|\beta\right|^2}
\]
If we express $\left|\alpha\right>$ and $\left|\beta\right>$ through
states $\ket{n}$,  we obtain the formula 
\begin{equation}
R\left(\alpha^{*}, \beta\right) = \sum_{(n)}\sum_{(m)}
\frac{\left(\alpha^{*}\right)^n \left(\beta\right)^m}{\sqrt{n!m!}}\rho_{nm}
\end{equation}
i.e. $R\left(\alpha^{*}, \beta\right)$ is easily found if the density matrix 
\rindex{Density matrix}
is known in the Fock basis (photon number representation). As an example, consider thermal excitation of a mode: 
\begin{eqnarray}
R\left(\alpha^{*}, \beta\right) = \sum_{(n)}\sum_{(m)}
\frac{\left(\alpha^{*}\right)^n \left(\beta\right)^m}{\sqrt{n!m!}}
e^{-\beta n \hbar \omega}\left(1  -  e^{-\beta \hbar \omega}\right)
\delta_{nm} = 
\nonumber \\
= \sum_{(n)}\frac{\left(\alpha^{*} \beta\right)^n }{n!}
e^{-\beta n \hbar \omega}\left(1  -  e^{-\beta \hbar \omega}\right) =
\left(1  -  e^{-\beta \hbar \omega}\right) e^{\alpha^{*}\beta
  e^{-\beta \hbar \omega}}.
\end{eqnarray}

This representation depends on two parameters $\alpha^{*}$ and $\beta$.
Another representation of the density matrix, introduced by R. Glauber \cite{bQuantumOpticsAndRadioPhisicsLecture1966}, called the 
diagonal representation and depending on one parameter, may be more convenient. It has the form  
\begin{equation}
\hat{\rho} = \int
P\left(\alpha\right)\left|\alpha\right>\left<\alpha\right| d^2 \alpha,
\label{eqCh1_rhorepresent}
\end{equation}
where  $P\left(\alpha\right)$ is a real function,
satisfying the condition 
\[
\int
P\left(\alpha\right) d^2 \alpha = 1.
\]
Moreover, $P\left(\alpha\right)$ is a real function of a complex
argument. This follows from the conditions  $Sp\left(\hat{\rho}\right) = 1$
and  $\hat{\rho} = \hat{\rho}^{\dag}$.
  
Such a decomposition is possible due to the overcompleteness of the system of coherent
states. If   $P\left(\alpha\right)$  is a positive function, it
can be interpreted 
as a probability distribution. This applies to some of the most
practically interesting field states, for example, to the completely chaotic state, but it is not true in general.
Sometimes   $P\left(\alpha\right)$  may be negative in
some restricted region of values of $\alpha$,  and then it cannot be interpreted as
a probability distribution.   $P\left(\alpha\right)$ may also be a generalized function
(an example is the $\delta$-function). 

A rigorous justification of the possibility of representation \eqref{eqCh1_rhorepresent}
is contained in the literature \cite{bQuantumOpticsAndRadioPhisicsLecture1966},
\cite{bKaluderSudershan1970}. 
The possibility to introduce the diagonal representation
\eqref{eqCh1_rhorepresent} can be justified as follows. Let the
statistical operator $\hat{\rho}$, like any other operator
acting on the electromagnetic field, be representable as
a function of creation and annihilation operators:
\[
\hat{\rho} = \bar{f}\left(\hat{a}^{\dag}, \hat{a}\right).
\]
Then the operator can be represented in an ordered form: normal
and antinormal. In the first case, creation operators are to the right of annihilation operators,
in the second case vice versa - to the left.
For example, 
\[
\left(\hat{a}^{\dag}\right)^m\left(\hat{a}\right)^n
\]
is a normally ordered operator. In an antinormally ordered
operator, the order is reversed: creation operators stand to the right of
annihilation operators. For example, the operator 
\[
\left(\hat{a}\right)^n\left(\hat{a}^{\dag}\right)^m
\]
is antinormally ordered. Ordering can be achieved by repeated
application of the commutation relation. For example, the operator  
\[
\left(\hat{a}^{\dag}\hat{a}\right)^2 =
\hat{a}^{\dag}\hat{a}\hat{a}^{\dag}\hat{a} 
\]
is neither normal nor antinormal. Using the relation
$\left[\hat{a},\hat{a}^{\dag}\right] = 1$,
bring it to the normal form: 
\[
\left(\hat{a}^{\dag}\hat{a}\right)^2 = \hat{a}^{\dag}\left(1 +
\hat{a}^{\dag}\hat{a}\right)\hat{a} = 
\hat{a}^{\dag}\hat{a} + \left(\hat{a}^{\dag}\right)^2\left(\hat{a}\right)^2.
\]
This operator can also be represented in the antinormal form:
\begin{eqnarray}
\left(\hat{a}^{\dag}\hat{a}\right)^2 = 
\left(\hat{a}\hat{a}^{\dag} - 1\right) \left(\hat{a}\hat{a}^{\dag} -
1\right) = \hat{a}\hat{a}^{\dag} \hat{a}\hat{a}^{\dag} - 2
\hat{a}\hat{a}^{\dag} + 1 =
\nonumber \\
= \hat{a}\left(\hat{a}\hat{a}^{\dag} - 1\right)\hat{a}^{\dag} -
2\hat{a}\hat{a}^{\dag} + 1 = 
\left(\hat{a}\right)^2\left(\hat{a}^{\dag}\right)^2 - 3
\hat{a}\hat{a}^{\dag} + 1.
\nonumber
\end{eqnarray}

There are also other, more efficient methods of operator ordering
\cite{bLuisell1972}.


Let us represent the density operator in
antinormal form (considering a single-mode case): 
\begin{equation}
\hat{\rho}^{\left(a\right)}\left(\hat{a},\hat{a}^{\dag}\right) = 
\sum_{(n)}\sum_{(m)}C^{\left(a\right)}_{nm}\left(\hat{a}\right)^n\left(\hat{a}^{\dag}\right)^m.
\end{equation}
Now use the decomposition \eqref{eqCh1_full4coh} for the identity operator $\hat{I}$
\[
\hat{I} = \frac{1}{\pi}\int \left|\alpha\right>\left<\alpha\right| d^2 \alpha,
\]
and we get
\begin{eqnarray}
\hat{\rho}^{\left(a\right)}\left(\hat{a},\hat{a}^{\dag}\right) = 
\sum_{(n)}\sum_{(m)}C^{\left(a\right)}_{nm}\left(\hat{a}\right)^n\hat{I}\left(\hat{a}^{\dag}\right)^m
= 
\nonumber \\
= \frac{1}{\pi}\sum_{(n)}\sum_{(m)}C^{\left(a\right)}_{nm}\int d^2 \alpha
\left(\hat{a}\right)^n
\left|\alpha\right>\left<\alpha\right|
\left(\hat{a}^{\dag}\right)^m = 
\nonumber \\
= \frac{1}{\pi}\sum_{(n)}\sum_{(m)}\int d^2 \alpha
C^{\left(a\right)}_{nm}
\alpha^n
\alpha^{*m}
\left|\alpha\right>\left<\alpha\right|.
\end{eqnarray}
Denoting now 
\[
P\left(\alpha, \alpha^{*}\right) = \frac{1}{\pi}\sum_{(n)}\sum_{(m)}
C^{\left(a\right)}_{nm}
\alpha^n
\alpha^{*m},
\]
we obtain that $\hat{\rho}$ can be represented as
\begin{equation}
\hat{\rho} = \int d^2 \alpha P\left(\alpha, \alpha^{*}\right) 
\left|\alpha\right>\left<\alpha\right|.
\label{eqCh1_Rho_in_alpha}
\end{equation}

The expectation value of an operator using
the diagonal representation is 
\begin{eqnarray}
\left<\hat{O}\right> = Sp \left(\hat{\rho}\hat{O}\right) =
\nonumber \\
= \sum_{(n)}\bra{n}
\int d^2 \alpha P\left(\alpha, \alpha^{*}\right) 
\left|\alpha\right>\left<\alpha\right|
\hat{O}\ket{n} =
\nonumber \\
= \sum_{(n)} \int d^2 \alpha P\left(\alpha, \alpha^{*}\right)
\left<\alpha\right|\hat{O}\ket{n}
\bra{n}\left.\alpha\right> = 
\nonumber \\
=  
\int d^2 \alpha P\left(\alpha, \alpha^{*}\right)
\left<\alpha\right|\hat{O}\left|\alpha\right>,
\label{eqCh1_middleO}
\end{eqnarray}
since $\sum_{(n)}\ket{n}\bra{n} = \hat{I}$. 

The expression $\left<\alpha\right|\hat{O}\left|\alpha\right>$ is easily
calculated if the operator $\hat{O}$ is represented in normal order:
\begin{equation}
\hat{O} = \hat{O}^{(n)} = \sum_{(n)}\sum_{(m)} d_{nm}
\left(\hat{a}^{\dag}\right)^n
\left(\hat{a}\right)^m,
\label{eqCh1_normalO}
\end{equation}
then
\begin{equation}
\left<\alpha\right|\hat{O}\left|\alpha\right> = 
\sum_{(n)}\sum_{(m)} d_{nm}
\left<\alpha\right|
\left(\hat{a}^{\dag}\right)^n
\left(\hat{a}\right)^m
\left|\alpha\right> = 
\sum_{(n)}\sum_{(m)} d_{nm}
\alpha^{*n}\alpha^{m}.
\end{equation}
From this, a simple rule follows: to obtain the required matrix element, one must replace $\hat{a}\rightarrow\alpha$, 
$\hat{a}^{\dag}\rightarrow\alpha^{*}$ in the operator represented in normal order.

As an example, let us show that for thermal excitation of the mode 
\begin{equation}
P\left(\alpha, \alpha^{*}\right) = \frac{1}{\pi \bar{n}}
e^{- \frac{\left|\alpha\right|^2}{\bar{n}}}
\label{eqCh1_123a}
\end{equation}
and, consequently,
\[
\hat{\rho} = \frac{1}{\pi \bar{n}}
\int d^2 \alpha 
e^{- \frac{\left|\alpha\right|^2}{\bar{n}}}
\left|\alpha\right>
\left<\alpha\right|.
\]
Let us now find the matrix elements of the operator $\hat{\rho}$ in
the Fock basis (photon number basis)
\begin{eqnarray}
\bra{n}
\hat{\rho}
\ket{n} = 
\frac{1}{\pi \bar{n}}
\int d^2 \alpha 
e^{- \frac{\left|\alpha\right|^2}{\bar{n}}}
\bra{n}\left.\alpha\right>
\left<\alpha\right|
\ket{n} = 
\nonumber \\
= 
\frac{1}{\pi \bar{n}}
\int d^2 \alpha 
e^{- \frac{\left|\alpha\right|^2}{\bar{n}}}
\frac{\left|\alpha\right|^{2n}}{n!} 
e^{- \left|\alpha\right|^2} .
\nonumber 
\end{eqnarray}
The resulting integral can be calculated by expressing it in polar coordinates:
\[
\alpha = r e^{i \varphi}, \quad 
d^2 \alpha = r d r d \varphi , \quad 
\text{i.e.} 
\left|\alpha\right| = r, \quad \arg \alpha = \varphi,
\]
from which
\begin{eqnarray}
\frac{1}{\pi \bar{n}}
\int d^2 \alpha 
e^{- \frac{\left|\alpha\right|^2}{\bar{n}}}
\frac{\left|\alpha\right|^{2n}}{n!} 
e^{- \left|\alpha\right|^2} =
\nonumber \\
=
\frac{1}{\pi \bar{n}}
\int_0^{2 \pi} d \varphi 
\int_0^{\infty}
r dr \frac{exp \left(- r^2\frac{\bar{n} + 1}{\bar{n}}\right)}{n!} r^{2n}= 
\nonumber \\
= 
\frac{1}{\bar{n}}
\int_0^{\infty}
2 r dr \frac{exp \left(- r^2\frac{\bar{n} + 1}{\bar{n}}\right)}{n!}  r^{2n} = 
\nonumber \\
= 
\frac{1}{\bar{n}}
\int_0^{\infty}
\frac{e^{-x}}{n!}\frac{\bar{n}^{n + 1}}
{\left(\bar{n} + 1\right)^{n + 1}}x^n dx = 
\nonumber \\
=
\frac{\bar{n}^{n}}
{\left(\bar{n} + 1\right)^{n + 1}}
\frac{1}{n!}
\int_0^{\infty}
e^{-x}x^n dx = 
\frac{\bar{n}^{n}}
{\left(\bar{n} + 1\right)^{n + 1}},
\label{eqCh1_matrelemRho}
\end{eqnarray}
where the substitution $x = r^2\frac{\bar{n} + 1}{\bar{n}}$ was made.

Thus, we have obtained the known matrix element
of the statistical operator of a chaotic field in the photon number representation. 
It follows that expression \eqref{eqCh1_123a}
indeed corresponds to the statistical operator of a chaotic field in
the coherent state representation. Therefore, for the thermal excitation of photons in a mode we have
\begin{equation}
P\left(\alpha\right) = \frac{1}{\pi \bar{n}}
e^{-\frac{\left|\alpha\right|^2}{\bar{n}}},
\mbox{where }
\bar{n} = \frac{1}{e^{\hbar \omega \beta} - 1}
\label{eqCh1_task4}
\end{equation}
  
Generalization of the obtained expressions to the multimode case is straightforward: 
\begin{equation}
\left<\hat{O}\right> = \idotsint\limits_{\left\{\alpha_k\right\}}
P^{(a)}
\left(
\left\{\alpha_k\right\}
\right)
O^{(n)}
\left(
\left\{\alpha_k\right\}
\right)
\prod_k d^2 \alpha_k,
\label{eqCh1_113}
\end{equation}
\[
P^{(a)}
\left(
\left\{\alpha_k\right\}
\right)
=
\prod_k \frac{1}{\pi \bar{n}_k}
e^{-\frac{\left|\alpha_k\right|^2}{\bar{n}_k}}. 
\]