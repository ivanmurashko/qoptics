%% -*- coding:utf-8 -*- 
\section{Damping of the Resonator Mode. Heisenberg-Langevin Equation.}

\subsection{Problem Statement.}
We consider the problem of relaxation of the resonator field (mode) using the density matrix method, i.e., the Schr√∂dinger representation. There is another approach belonging to Langevin, in which the equations of the dynamical system are supplemented with random forces, the statistical properties of which are known, to take into account the influence of the dissipative system. In the quantum case, the dynamical equations are the Heisenberg equations for the operators of observable quantities, and the random effects associated with the thermostat are taken into account by adding some noise operator. The resulting equations are called the Heisenberg-Langevin equations.

Let us consider the problem of relaxation of the resonator mode (harmonic oscillator) interacting with a thermostat by this method. In the Heisenberg representation, operators depend on time and satisfy the Heisenberg equations:
\begin{equation}
\frac{d \hat{O}}{dt} = \frac{i}{\hbar}
\left[\hat{\mathcal{H}}, \hat{O}\right],
\nonumber
\end{equation}
\rindex{Hamiltonian}
where $\hat{\mathcal{H}}$ is the Hamiltonian of the system under consideration. For example, for the free field we previously obtained equations \eqref{eqCh1_54}:
\begin{equation}
\frac{d \hat{a}}{d t} = \frac{i}{\hbar}\left[\hat{\mathcal{H}},
  \hat{a}\right] = -i \omega \hat{a}, \quad
\frac{d \hat{a}^{\dag}}{dt} = \frac{i}{\hbar}\left[\hat{\mathcal{H}},
  \hat{a}^{\dag}\right] = i \omega \hat{a}^{\dag},
\nonumber
\end{equation}
where $\omega$ is the mode frequency, and $\hat{a}$ and $\hat{a}^{\dag}$ are annihilation and creation operators.

\input ./part1/interaction/fig_add3.tex

The problem under consideration is schematically shown in \autoref{figPart1Ch2_add3}. The electromagnetic field mode, considered as a dynamical system, interacts with a large reservoir consisting of a large number of harmonic oscillators (phonons) in equilibrium at temperature $T$. The Hamiltonian of such a system can be represented as
\begin{equation}
\hat{\mathcal{H}} = \hat{\mathcal{H}}_0 + \hat{V},
\nonumber
\end{equation}
where
\begin{equation}
 \hat{\mathcal{H}}_0 = \hbar\omega \hat{a}^{\dag}\hat{a} +
\sum_{(k)} \hbar\omega_k \hat{b}_k^{\dag} \hat{b}_k
\nonumber
\end{equation}
is the Hamiltonian of the system without interaction between its parts,
\begin{equation}
 \hat{V} = \hbar \sum_{(k)}g_k\left(
\hat{b}_k^{\dag}\hat{a} + \hat{a}^{\dag}\hat{b}_k
\right)
\label{eqPart1Ch2_LanzgevenV}
\end{equation}
is the Hamiltonian of the interaction between the dynamical system and the thermostat. The constant of interaction for the $k$-th reservoir mode is denoted by $g_k$ in \eqref{eqPart1Ch2_LanzgevenV}. Here, $\hat{a}$, $\hat{a}^{\dag}$ are annihilation and creation operators for the field mode, and $\hat{b}_k$, $\hat{b}_{k}^{\dag}$ are annihilation and creation operators for the $k$-th reservoir mode (phonons). Vacuum terms in the Hamiltonian are neglected since they cancel out during the derivation of the equations.

\subsection{Heisenberg Equations of Motion for Operators.}
The Heisenberg equations of motion for $\hat{a}$ and $\hat{b}_{k}$:
\begin{eqnarray}
\frac{d \hat{a}}{d t} = \frac{i}{\hbar}\left[
 \hat{\mathcal{H}}, \hat{a}
\right],
\nonumber \\
\frac{d \hat{b}_k}{d t} = \frac{i}{\hbar}\left[
 \hat{\mathcal{H}}, \hat{b}_k
\right]
\nonumber
\end{eqnarray}
using the commutation relations 
$\left[\hat{a}, \hat{a}^{\dag}\right] = 1$ and 
$\left[\hat{b}_k, \hat{b}_{k}^{\dag}\right] = 1$ transform to the form
\begin{eqnarray}
\frac{d \hat{a}\left(t\right)}{d t} = -i \omega \hat{a}\left(t\right) - i\sum_{(k)}g_k
\hat{b}_k\left(t\right),
\nonumber \\
\frac{d \hat{b}_k\left(t\right)}{d t} = -i \omega_k
\hat{b}_{k}\left(t\right) - i g_k \hat{a}\left(t\right).
\label{eqPart1Ch2_LanzgevenAB}
\end{eqnarray}
From system \eqref{eqPart1Ch2_LanzgevenAB} one can exclude $\hat{b}_k$ by integrating the second equation and substituting the result into the first equation. Integration is simplest using operational calculus. We obtain
\begin{equation}
\hat{b}_k\left(t\right) = 
\hat{b}_k\left(0\right) e^{-i \omega_k t} 
- i g_k \int_0^t d t' \hat{a}\left(t'\right)e^{-i \omega_k\left(t - t'\right)}
\nonumber
\end{equation}
and then
\begin{eqnarray}
\frac{d \hat{a}\left(t\right)}{dt} = 
- i \omega \hat{a}\left(t\right) - \sum_{(k)} g_k^2 \int_0^t
d t'  \hat{a}\left(t'\right)e^{-i \omega_k\left(t - t'\right)}
+ \hat{f}\left(t\right),
\nonumber \\
\hat{f}\left(t\right) = -i \sum_{(k)} g_k \hat{b}_k\left(0\right)
e^{-i \omega_k t}.
\label{eqPart1Ch2_LanzgevenA}
\end{eqnarray}
The operator $\hat{f}\left(t\right)$ depends on thermostat variables and is a noise operator describing the influence of the reservoir on the dynamical system.

Equation \eqref{eqPart1Ch2_LanzgevenA} is integro-differential. Under some approximations, it can be transformed into a purely differential equation. First, we switch to slow variables by writing
\begin{eqnarray}
\hat{a}\left(t\right) = \hat{A}\left(t\right)e^{-i \omega t},
\nonumber \\
\hat{f}\left(t\right) = \hat{F}\left(t\right)e^{-i \omega t},
\nonumber
\end{eqnarray}
where $\omega$ is the mode frequency. From this we have
\begin{equation}
\frac{d \hat{A}\left(t\right)}{dt} = 
- \sum_{(k)} g_k^2 \int_0^t
d t'  \hat{A}\left(t'\right)e^{i \left(\omega -
  \omega_k\right)\left(t - t'\right)} 
+ \hat{F}\left(t\right).
\label{eqPart1Ch2_LanzgevenAA}
\end{equation}
% where 
% $\hat{F}\left(t\right) = \hat{f}\left(t\right) e^{i \omega t}$. 
The first term on the right-hand side of \eqref{eqPart1Ch2_LanzgevenAA} resembles the term encountered when considering spontaneous emission using the Weisskopf-Wigner method. The approach applied there can be applied here as well. From \eqref{eqPart1Ch2_LanzgevenAA} it is clear that the main contributions come from terms with frequencies close to the mode frequency: $\omega_k \approx \omega$. For this reason, all slowly varying terms can be taken at frequency $\omega$ and taken out of the integral. Summation over $k$, assuming a quasi-continuous phonon spectrum, can be replaced by integration over frequency:
\begin{eqnarray}
\sum_{(k)}g_k^2\int_0^t d t' \hat{A}\left(t'\right) e^{i\left(\omega -
  \omega_k\right)\left(t - t'\right)} = 
\nonumber \\
=
\int_0^t d t'
  \hat{A}\left(t'\right)\int_0^{\infty}g^2\left(\omega\right) 
D\left(\omega\right) e^{i\left(\omega -
  \omega'\right)\left(t - t'\right)} d \omega' = 
\nonumber \\
= g^2\left(\omega\right) 
D\left(\omega\right)
\int_0^t d t'
  \hat{A}\left(t'\right)
\int_0^{\infty}e^{i\left(\omega -
  \omega'\right)\left(t - t'\right)} d \omega',
\nonumber
\end{eqnarray}
where $D\left(\omega\right)$ is the density of states.
$D\left(\omega\right)$ and $g^2\left(\omega\right)$ are taken at the frequency of the field mode and factored out of the integral.

Consider the integral over frequency. Acting as when considering spontaneous emission by the Weisskopf-Wigner method, we get
\begin{eqnarray}
\int_0^{\infty}e^{- i\left(\omega' -
  \omega\right)\left(t - t'\right)} d \omega' = 
\int_{-\omega}^{\infty} e^{-i \nu \left(t - t'\right)} d \nu \approx 
\int_{-\infty}^{\infty} e^{-i \nu \left(t - t'\right)} d \nu = 
\nonumber \\
= \int_{-\infty}^{\infty} e^{i \nu \left(t' - t\right)} d \nu = 
2 \pi \delta\left(t' - t\right).
\nonumber
\end{eqnarray}
Therefore, one can write
\begin{eqnarray}
\frac{d \hat{A}\left(t\right)}{d t} = 
- 2 \pi g^2\left(\omega\right) 
D\left(\omega\right)
\int_0^t d t'
  \hat{A}\left(t'\right)
\delta\left(t - t'\right)  + \hat{F}\left(t\right) = 
\nonumber \\
=
- 2 \pi g^2\left(\omega\right) 
D\left(\omega\right) \hat{A}\left(t\right)
 + \hat{F}\left(t\right).
\nonumber
\end{eqnarray}
Define
\(
\left.2 \pi D g^2\right|_{\omega} = \frac{\gamma}{2}
\) as the field damping coefficient. We obtain
\begin{equation}
\frac{d \hat{A}\left(t\right)}{d t} = 
- \frac{\gamma}{2} \hat{A}\left(t\right) + 
\hat{F}\left(t\right),
\label{eqPart1Ch2_LanzgevenAeq}
\end{equation}
where $\hat{F}\left(t\right)$ is the random noise operator whose properties must be determined. As will be seen later, the noise operator ensures the preservation of commutation relations for the field mode operator.

Let us now study the statistical properties characterized by the correlation functions of $\hat{F}$. Assume the reservoir is in thermal equilibrium at temperature $T$. Then we have:
\begin{eqnarray}
\left<\hat{b}_k\left(0\right)\right>_R = 
\left<\hat{b}_k^{\dag}\left(0\right)\right>_R = 0, 
\nonumber \\
\left<\hat{b}_k^{\dag}\left(0\right)\hat{b}_{k'}\left(0\right)\right>_R = 
\bar{n}_k \delta_{k k'},
\nonumber \\
\left<\hat{b}_k\left(0\right)\hat{b}_{k'}^{\dag}\left(0\right)\right>_R = 
\left(\bar{n}_k + 1\right)\delta_{k k'},
\nonumber \\
\left<\hat{b}_k\left(0\right)\hat{b}_{k'}\left(0\right)\right>_R = 
\left<\hat{b}_k^{\dag}\left(0\right)\hat{b}_{k'}^{\dag}\left(0\right)\right>_R
= 0,
\label{eqPart1Ch2_LanzgevenPropertyF}
\end{eqnarray}
where $\left<\dots\right>_R$ denotes averaging over thermostat variables, and $\bar{n}_k$ is the average number of phonons in mode $k$. The noise operator was defined by the formula 
\begin{equation}
\hat{F}\left(t\right) = -i \sum_{(k)}g_k 
\hat{b}_k\left(0\right)
e^{-i \left(\omega_k - \omega\right)t}.
\label{eqPart1Ch2_LanzgevenDefenitionF}
\end{equation}
Using \eqref{eqPart1Ch2_LanzgevenPropertyF}, it is easy to see
\begin{eqnarray}
\left<\hat{F}\left(t\right)\right>_R =
\left<\hat{F}^{\dag}\left(t\right)\right>_R  = 0,
\nonumber \\
\left<\hat{F}^{\dag}\left(t\right)\hat{F}\left(t'\right)\right>_R = 
\nonumber \\
= \sum_{k}\sum_{k'}g_k g_{k'}
\left<\hat{b}_k^{\dag}\left(0\right)\hat{b}_{k'}\left(0\right)\right>_R 
e^{i\left(\omega_k - \omega\right)t} 
 e^{-i\left(\omega_{k'} - \omega\right)t'} =
\nonumber \\
= \sum_{k}g_k^2 \bar{n}_k 
e^{i\left(\omega_k - \omega\right)\left(t - t'\right)} = 
\nonumber \\
=
\int_0^\infty
g^2\left(\omega\right)D\left(\omega\right)\bar{n}_T
e^{i\left(\omega' - \omega\right)\left(t - t'\right)}d \omega' = 
\nonumber \\
= 2 \pi
g^2\left(\omega\right)D\left(\omega\right)\bar{n}_T
\delta\left(t - t'\right) =
\frac{\gamma \bar{n}_{T}}{2} \delta\left(t - t'\right),
\label{eqPart1Ch2_LanzgevenCorrelations}
\end{eqnarray}
where $\bar{n}_T$ is the average number of phonons in the reservoir mode at temperature $T$, determined by Planck's formula,
$\gamma = 4 \pi g^2\left(\omega\right)D\left(\omega\right)$.
If, according to Langevin, we introduce the diffusion coefficient $\mathcal{D} =
\frac{\gamma \bar{n}_{T}}{2}$, then the last equation of system
\eqref{eqPart1Ch2_LanzgevenCorrelations} can be written as
\begin{equation}
\left<\hat{F}^{\dag}\left(t\right)\hat{F}\left(t'\right)\right>_R = 
\mathcal{D} \delta\left(t - t'\right). 
\nonumber
\end{equation}
Note that $\left<\dots\right>_R$ denotes averaging over thermostat variables, so the result of averaging is a correlation function depending only on the dynamical system variables (field).

Similarly, one can prove
\begin{equation}
\left<\hat{F}\left(t\right)\hat{F}^{\dag}\left(t'\right)\right>_R = 
\frac{\gamma\left(\bar{n}_{T} + 1\right)}{2} \delta\left(t - t'\right)
\label{eqPart1Ch2_Lanzgeven_Task1}
\end{equation}
and
\begin{equation}
\left<\hat{F}\left(t\right)\hat{F}\left(t'\right)\right>_R = 
\left<\hat{F}^{\dag}\left(t\right)\hat{F}^{\dag}\left(t'\right)\right>_R = 0.
\label{eqPart1Ch2_Lanzgeven_Task2}
\end{equation}
Thus, in our approximation, the noise is $\delta$-correlated.

We still need the correlation function of the type
\(
\left<\hat{F}^{\dag}\left(t\right)\hat{A}\left(t'\right)\right>_R 
\) 
which is necessary for deriving the equation satisfied by 
\(
\left<\hat{A}^{\dag}\left(t\right)\hat{A}\left(t'\right)\right>_R 
\). For this, integrate the equation for $\hat{A}\left(t\right)$
\eqref{eqPart1Ch2_LanzgevenAeq}, and using operational calculus, obtain
\begin{equation} 
\hat{A}\left(t\right) = \hat{A}\left(0\right)e^{-\frac{\gamma}{2}t} +
\int_0^t d t' e^{-\frac{\gamma}{2}\left(t - t'\right)} \hat{F}\left(t'\right).
\nonumber
\end{equation} 
Multiply this expression by $\hat{F}^{\dag}\left(t\right)$ and average over the thermostat. We get
\begin{eqnarray} 
\left<\hat{F}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R = 
\int_0^t  
\left<\hat{F}^{\dag}\left(t\right)\hat{F}\left(t'\right)\right>_R 
e^{-\frac{\gamma}{2}\left(t - t'\right)}
d t' +
\nonumber \\
+ \left<\hat{F}^{\dag}\left(t\right)\hat{A}\left(0\right)\right>_R e^{-\frac{\gamma}{2}t}.
\label{eqPart1Ch2_LanzgevenFACorr}
\end{eqnarray} 
The last term in \eqref{eqPart1Ch2_LanzgevenFACorr} is zero since 
$\hat{F}^{\dag}\left(t\right)$ and $\hat{A}\left(0\right)$ are independent,
%\footnote{$\hat{F}^{\dag}\left(t\right)$ at a later time
% cannot influence $\hat{A}\left(0\right)$ at the initial time} 
and their averages are zero. Taking into account the second equation of system 
\eqref{eqPart1Ch2_LanzgevenCorrelations}, i.e.,
\(
\left<\hat{F}^{\dag}\left(t\right)\hat{F}\left(t'\right)\right>_R = 
\frac{\gamma \bar{n}_{T}}{2} \delta\left(t - t'\right),
\)
we obtain
\begin{equation}
\left<\hat{F}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R = 
\frac{\gamma \bar{n}_{T}}{2}.
\nonumber
\end{equation}
Now consider the correlation function 
\(
\left<\hat{A}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R
\). Differentiating this function with respect to time, we get
\begin{equation}
\frac{d \left<\hat{A}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R}{d
t}=
\left<\frac{d \hat{A}^{\dag}\left(t\right)\hat{A}\left(t\right)}{d
t}\right>_R =
\left<\frac{d \hat{A}^{\dag}\left(t\right)}{d
t} \hat{A}\left(t\right) \right>_R + 
\left<\hat{A}^{\dag}\left(t\right)\frac{d \hat{A}\left(t\right)}{d
t}  \right>_R.
\label{eqPart1Ch2_Lanzgeven_dAA}
\end{equation}
Then use equation \eqref{eqPart1Ch2_LanzgevenAeq} and its conjugate, resulting in
\begin{equation}
\frac{d \left<\hat{A}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R}{d
t}=
- \gamma \left<\hat{A}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R
+ \left<\hat{F}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R + 
\left<\hat{A}^{\dag}\left(t\right)\hat{F}\left(t\right)\right>_R.
\nonumber
\end{equation}
Considering the expressions 
\begin{equation}
\left<\hat{F}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R =
\left<\hat{A}^{\dag}\left(t\right)\hat{F}\left(t\right)\right>_R = 
\frac{\gamma \bar{n}_T}{2},
\nonumber
\end{equation}
we finally get
\begin{equation}
\frac{d \left<\hat{A}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R}{d
t}=
- \gamma \left<\hat{A}^{\dag}\left(t\right)\hat{A}\left(t\right)\right>_R
+ \gamma \bar{n}_T.
\nonumber
\end{equation}
Similarly, one can derive
\begin{equation}
\frac{d \left<\hat{A}\left(t\right)\hat{A}^{\dag}\left(t\right)\right>_R}{d
t}=
- \gamma \left<\hat{A}\left(t\right)\hat{A}^{\dag}\left(t\right)\right>_R
+ \gamma \left(\bar{n}_T + 1\right).
\label{eqPart1Ch2_Lanzgeven_Task3}
\end{equation}
Subtracting these expressions, we obtain for the commutator
\begin{equation}
\frac{d \left<\left[\hat{A}\left(t\right),\hat{A}^{\dag}\left(t\right)\right]\right>_R}{d
t}=
\gamma \left( 1 - \left<\left[\hat{A}\left(t\right),\hat{A}^{\dag}\left(t\right)\right]\right>_R
\right).
\label{eqPart1Ch2_Lanzgeven_CommutatorAA}
\end{equation}
From equation \eqref{eqPart1Ch2_Lanzgeven_CommutatorAA} it follows that if at the initial moment
\[
\left<\left[\hat{A}\left(0\right),\hat{A}^{\dag}\left(0\right)\right]\right>_R
= 1,
\]
i.e., commutation relations hold, then these relations will always hold. In other words, commutation relations averaged over thermostat variables are preserved over time.

The picture would be completely different if quantum noise were not taken into account. In that case, equation
\eqref{eqPart1Ch2_Lanzgeven_CommutatorAA} would take the form
\begin{equation}
\frac{d \left<\left[\hat{A}\left(t\right),\hat{A}^{\dag}\left(t\right)\right]\right>_R}{d
t}=
- \gamma \left<\left[\hat{A}\left(t\right),\hat{A}^{\dag}\left(t\right)\right]\right>_R,
\nonumber
\end{equation}
the solution of which is
\begin{equation}
\left<\left[\hat{A}\left(t\right),\hat{A}^{\dag}\left(t\right)\right]\right>_R
= 
\left<\left[\hat{A}\left(0\right),\hat{A}^{\dag}\left(0\right)\right]\right>_R
e^{- \gamma t}= e^{- \gamma t}.
\nonumber
\end{equation}
This means that after sufficiently long time, operators $\hat{A}$ and
$\hat{A}^{\dag}$ would commute, which is actually not observed. For this reason, accounting for the quantum noise term is mandatory.

The equation of motion for the field averaged over thermostat variables is easily obtained from \eqref{eqPart1Ch2_LanzgevenAeq}. First, write the averaged field
\begin{eqnarray}
\left<\hat{E}\left(t\right)\right>_R 
= \left< E_0 \sin kz \left( \hat{a}\left(t\right) +
\hat{a}^{\dag}\left(t\right)\right)\right>_R  = 
\nonumber \\
= E_0 \sin kz
\left(\left<\hat{A}\left(t\right)\right>_R e^{-i \omega t}
+
\left<\hat{A}^{\dag}\left(t\right)\right>_R e^{i \omega t}
\right),
\nonumber
\end{eqnarray}
taking into account $\hat{a} = \hat{A}e^{-i \omega t}$. From
\eqref{eqPart1Ch2_LanzgevenAeq}, we have
\begin{equation}
\frac{d \left<\hat{A}\left(t\right)\right>_R}{d t} = 
- \frac{\gamma}{2} \left<\hat{A}\left(t\right)\right>_R,
\nonumber
\end{equation}
since $\left<\hat{F}\left(t\right)\right>_R = 0$. Thus, over time
$\left<\hat{A}\left(t\right)\right>_R$ and
$\left<\hat{A}^{\dag}\left(t\right)\right>_R$, and with them  
$\left<\hat{E}\left(t\right)\right>_R$, tend to zero:
\begin{equation}
\left<\hat{E}\left(t\right)\right>_R \rightarrow 0.
\nonumber
\end{equation}

\subsection{Fluctuation-Dissipation Formula}
We obtained expression \eqref{eqPart1Ch2_LanzgevenCorrelations}:
\begin{equation}
\left<\hat{F}^{\dag}\left(t\right)\hat{F}\left(t'\right)\right>_R = 
\frac{\gamma \bar{n}_{T}}{2} \delta\left(t - t'\right).
\nonumber
\end{equation}
Integrating both sides over $d t'$, we get
\begin{equation}
\gamma =
\frac{2}{\bar{n}_T}\int_0^{\infty}\left<\hat{F}^{\dag}\left(t\right)\hat{F}\left(t'\right)\right>_R
d t',
\label{eqPart1Ch2_LanzgevenGamma}
\end{equation}
i.e., the decay rate and noise fluctuations are related by equation \eqref{eqPart1Ch2_LanzgevenGamma}. Greater decay corresponds to greater noise.
